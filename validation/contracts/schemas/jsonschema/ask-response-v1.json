{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "$id": "https://neuronews.com/schemas/api/ask-response-v1.json",
  "title": "Ask Response",
  "description": "Response schema for the /ask API endpoint",
  "type": "object",
  "properties": {
    "question": {
      "type": "string",
      "description": "The original question that was asked"
    },
    "answer": {
      "type": "string",
      "description": "The generated answer to the question"
    },
    "citations": {
      "type": "array",
      "description": "List of citations with sources used to generate the answer",
      "items": {
        "$ref": "#/definitions/Citation"
      }
    },
    "metadata": {
      "type": "object",
      "description": "Response metadata and timing information",
      "properties": {
        "total_time_ms": {
          "type": "number",
          "minimum": 0,
          "description": "Total response time in milliseconds"
        },
        "retrieval_time_ms": {
          "type": "number",
          "minimum": 0,
          "description": "Document retrieval time in milliseconds"
        },
        "generation_time_ms": {
          "type": "number",
          "minimum": 0,
          "description": "Answer generation time in milliseconds"
        },
        "documents_found": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of documents found for the query"
        },
        "documents_used": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of documents actually used for answer generation"
        },
        "reranked": {
          "type": "boolean",
          "description": "Whether documents were reranked"
        },
        "query_fusion_used": {
          "type": "boolean",
          "description": "Whether query fusion was applied"
        },
        "provider_used": {
          "type": "string",
          "description": "The answer generation provider that was used"
        }
      },
      "required": ["total_time_ms", "documents_found", "provider_used"],
      "additionalProperties": true
    },
    "request_id": {
      "type": "string",
      "pattern": "^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$",
      "description": "Unique request identifier (UUID format)"
    },
    "tracked_in_mlflow": {
      "type": "boolean",
      "description": "Whether this request was logged to MLflow for tracking"
    }
  },
  "required": ["question", "answer", "citations", "metadata", "request_id", "tracked_in_mlflow"],
  "additionalProperties": false,
  "definitions": {
    "Citation": {
      "type": "object",
      "description": "Citation information for a source document",
      "properties": {
        "citation_id": {
          "type": "integer",
          "minimum": 1,
          "description": "Unique citation identifier within the response"
        },
        "title": {
          "type": "string",
          "description": "Title of the source article"
        },
        "source": {
          "type": "string",
          "description": "News source or publisher name"
        },
        "url": {
          "type": "string",
          "format": "uri",
          "description": "URL of the source article"
        },
        "relevance_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Relevance score of the document to the query (0-1)"
        },
        "published_date": {
          "type": "string",
          "format": "date-time",
          "description": "Publication date of the article (ISO 8601 format)"
        },
        "excerpt": {
          "type": "string",
          "description": "Relevant excerpt from the article"
        },
        "citation_strength": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Strength of the citation in supporting the answer (0-1)"
        }
      },
      "required": ["citation_id", "title", "source", "url", "relevance_score", "published_date", "excerpt", "citation_strength"],
      "additionalProperties": false
    }
  },
  "examples": [
    {
      "question": "What are the latest developments in AI technology?",
      "answer": "Recent developments in AI technology include breakthroughs in large language models, improved computer vision capabilities, and advances in autonomous systems. Major tech companies have announced new AI chips designed for better performance and energy efficiency.",
      "citations": [
        {
          "citation_id": 1,
          "title": "AI Chip Breakthrough Announced by Tech Giants",
          "source": "TechNews",
          "url": "https://technews.com/ai-chip-breakthrough-2025",
          "relevance_score": 0.95,
          "published_date": "2025-08-28T10:30:00Z",
          "excerpt": "Major technology companies unveiled new AI processing chips that promise 50% better performance...",
          "citation_strength": 0.9
        }
      ],
      "metadata": {
        "total_time_ms": 1250.5,
        "retrieval_time_ms": 400.2,
        "generation_time_ms": 750.8,
        "documents_found": 15,
        "documents_used": 5,
        "reranked": true,
        "query_fusion_used": true,
        "provider_used": "openai"
      },
      "request_id": "550e8400-e29b-41d4-a716-446655440000",
      "tracked_in_mlflow": true
    }
  ]
}
