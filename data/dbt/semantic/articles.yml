version: 2

semantic_models:
  - name: articles
    description: "Normalized news articles at article grain."
    model: ref('articles_sample')   # temporarily using articles_sample for testing
    defaults:
      agg_time_dimension: published_at
    primary_entity: article
    entities:
      - name: article
        type: primary
        expr: article_id
      - name: source
        type: foreign
        expr: source_id
    dimensions:
      - name: published_at
        type: time
        expr: published_date
        type_params: 
          time_granularity: day
      - name: language
        type: categorical
      - name: country
        type: categorical
        expr: 'unknown'  # placeholder as country not directly available
    measures:
      - name: articles_count
        description: "Distinct articles."
        agg: count_distinct
        expr: article_id
        create_metric: true
      - name: avg_sentiment
        description: "Average sentiment score (-1..1)."
        agg: average
        expr: sentiment_score
      - name: sources_count
        description: "Distinct sources per slice."
        agg: count_distinct
        expr: source_id
