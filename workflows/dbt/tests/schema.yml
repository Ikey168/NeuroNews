version: 2

models:
  - name: fct_articles
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - article_id
            - source_id
    columns:
      - name: article_id
        tests:
          - not_null
          - unique

      - name: source_id
        tests:
          - not_null

      - name: published_at
        tests:
          - not_null
          - dbt_utils.expression_is_true:
              name: fct_published_at_not_future
              expression: "published_at <= current_timestamp()"

      - name: language
        tests:
          - not_null
          - accepted_values:
              name: fct_language_iso_codes
              values: ['en', 'es', 'fr', 'de', 'it', 'pt', 'ru', 'zh', 'ja', 'ar', 'ko', 'hi', 'tr', 'pl', 'nl', 'sv', 'da', 'no', 'fi', 'cs', 'hu', 'ro', 'bg', 'hr', 'sk', 'sl', 'et', 'lv', 'lt', 'mt', 'el', 'cy', 'ga', 'eu', 'ca', 'gl', 'is', 'mk', 'sq', 'sr', 'bs', 'me', 'xk', 'mo', 'be', 'uk', 'kk', 'ky', 'uz', 'tg', 'az', 'hy', 'ka', 'am', 'he', 'fa', 'ur', 'ps', 'ku', 'sd', 'ne', 'si', 'my', 'km', 'lo', 'th', 'vi', 'id', 'ms', 'tl']
              quote: false

      - name: sentiment_score
        tests:
          - dbt_utils.expression_is_true:
              name: fct_sentiment_score_range
              expression: "sentiment_score is null or (sentiment_score >= -1.0 and sentiment_score <= 1.0)"
